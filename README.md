## CorpRAG UI (demo)

UI‑прототип корпоративного RAG‑сервиса (React + TypeScript + Tailwind). Проект **полностью клиентский**: данные и «API» живут в `src/services/mockService.ts`, поэтому подходит для быстрого UX/Trust‑layer прогона и онбординга команды.

### Зачем это сделано

- **UX прототип**: проверить основные сценарии (чат → источники → доверие → админ/наблюдаемость → знания).
- **Trust‑layer**: показать пользователю источники, дать управление доступом и собрать обратную связь по качеству ответа.
- **База под реальную интеграцию**: мок‑методы и типы можно заменить на реальные API без переписывания UI.

---

## Онбординг (5 минут)

### Установка и запуск

```bash
npm install
npm start
```

Открой `http://localhost:3000`.

Если порт занят:

```bash
npm start -- --port 3001
```

### Куда смотреть в UI

- **Чат** (`/chat`)
  - слева: вкладки **Чаты / Коллекции**, поиск по чатам, кнопка **Новый чат**, удаление чата через троеточие
  - центр: диалог + **IVR быстрые вопросы внутри тела чата**
  - справа: **Источники / Поиск / Сессия**
    - топ‑источник №1 со стикером **«Лучшее совпадение»**
    - клик по источнику → **popup** с кнопками копирования и перехода по ссылке
    - лайк на ответ ассистента (зелёный) + подтверждение на 2 секунды
- **Знания** (`/knowledge`)
  - загрузка файлов (multi‑upload) с **прелоадером по количеству/прогрессу/времени**
  - таблица документов с колонками **Источник** и **Доступ**
  - клик по документу → панель управления доступом (source‑managed vs manual)
- **Активность** (`/dashboard`)
  - линейный график активности, donut по оценке полезности (помог/не помог)
- **Админ** (`/admin`)
  - вкладки: **Журнал / Неотвеченные / Политики / Аудит**
  - «Неотвеченные»: группировка вопросов по частоте, чтобы ответственный за наполнение мог реагировать

---

## Что реализовано (high level)

### Адаптивность

- мобильный режим: боковые панели в чате открываются drawer’ами, хедер — через мобильное меню

### Чаты (сессии)

- список чатов + поиск по названию/содержимому, моковые сессии
- удаление чата через hover‑меню + подтверждение
- индикатор непрочитанных ответов на пункте меню «Чат», если ответ пришёл пока пользователь на другой вкладке

### Trust‑layer: источники и обратная связь

- топ‑источник со стикером «Лучшее совпадение»
- popup источника
- лайк на ответ ассистента + подтверждение

### Знания и загрузка

- загрузка файлов в коллекцию с прогрессом и временем

### Разграничение доступа (ACL) — демо‑реализация

Основные принципы:

- **Наследование от источника** (`Confluence/SharePoint`): режим `source` (только ресинк, без ручной правки)
- **Ручной доступ** для `upload` (PDF/DOCX/…): пользователь/группа/роль/все сотрудники (read‑only для RAG)
- **Политики**: дефолтный доступ для upload, блок `confidential` в RAG, require verified email (в демо включается политикой)
- **Аудит**: события выдачи источников в RAG, изменения доступа, ресинк

Важно: это **мок**, но уже встроен в UX: `mockService.sendChat()` фильтрует источники по ACL.

### Админ: неотвеченные запросы

- вкладка «Неотвеченные»: агрегирование по частоте и сортировки (частота/недавние)

---

## Команды

```bash
npm start
npm run build
npm test
```

---

## Структура проекта

```
src/
├── components/          # React компоненты
│   ├── Layout.tsx      # Основной layout с навигацией
│   ├── ChatLayout.tsx  # Layout для страницы чата
│   └── chat/           # Компоненты чата
│       ├── CollectionsSidebar.tsx
│       ├── ChatSessionsSidebar.tsx
│       ├── ChatThread.tsx
│       ├── MessageBubble.tsx
│       ├── Composer.tsx
│       ├── RightPanel.tsx
│       ├── SourcesPanel.tsx
│       ├── RetrievalPanel.tsx
│       └── SessionPanel.tsx
├── pages/              # Страницы приложения
│   ├── ChatPage.tsx
│   ├── KnowledgePage.tsx
│   ├── DashboardPage.tsx
│   └── AdminPage.tsx
├── services/           # Сервисы
│   └── mockService.ts  # Мок-сервис с имитацией API
├── contexts/           # React контексты
│   └── ChatContext.tsx # Контекст для управления состоянием чата
├── types.ts            # TypeScript типы
└── App.tsx             # Главный компонент с роутингом
```

---

## Технологии

- **React** + **TypeScript**
- **CRA (react-scripts)**, **React Router**
- **Tailwind CSS**
- **lucide-react**, **react-markdown**

## Ограничения демо

- всё в памяти (перезагрузка страницы сбрасывает состояние)
- «интеграции» Confluence/SharePoint — мок‑логика (но UX и модель ACL уже заложены)
